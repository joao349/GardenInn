<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Page</title>
    <link rel="stylesheet" href="PaginaLogin.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Circular+Std:wght@400;500&display=swap" rel="stylesheet">
</head>

 <body style="font-family: playfair-display-uniquifier;">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Header Navigation -->
        <nav class="navbar navbar-expand-lg bg-body-tertiary w-100">
        <div class="container-fluid">
            <a href="PaginaInicial.html">
                <img class="LogoNav" src="Logo preta.png" alt="">
            </a>
            
        </div>
        </nav>

    <!-- Main Content with Login Form -->
    <main class="main-content">
        <div class="login-card">
            <div class="logo">
                <img src="Logo branca.png" alt="">
                <!-- Replace with actual logo SVG/image -->
            </div>
            <h2>Faça o log-in para continuar</h2>

            <form action="/paginaformulario.html" method="get" class="login-form">
                <input name="email" type="email" placeholder="Email" required>

                <input name="senha" type="password" placeholder="Senha" required>

                <button type="submit" class="login-btn">Log in</button>
            </form>

            <p class="signup-link" >Não possui uma conta? <a onclick="AdiconarNovoElemento()" class="signup-link-green">Sign up</a></p>
        </div>
    </main>


<script>

function AdiconarNovoElemento() {

    const ModalHtml = `
    <div class="modal fade" id="Adicionar" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title">Adicionar usuário</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <form id="formAdicionarUsuario">
                    <div class="modal-body">

                        <div class="input-group mb-3">
                            <span class="input-group-text">Primeiro nome</span>
                            <input name="PrimeiroNome" type="text" class="form-control">
                        </div>

                        <div class="input-group mb-3">
                            <span class="input-group-text">Segundo nome</span>
                            <input name="SegundoNome" type="text" class="form-control">
                        </div>

                        <div class="input-group mb-3">
                            <span class="input-group-text">E-mail</span>
                            <input name="email" type="email" class="form-control">
                        </div>

                        <div class="input-group mb-3">
                            <span class="input-group-text">Telefone</span>
                            <input name="telefone" type="tel" class="form-control">
                        </div>

                        <div class="input-group mb-3">
                            <span class="input-group-text">Senha</span>
                            <input id="password" name="senha" type="password" class="form-control">
                        </div>

                        <div class="input-group mb-3">
                            <span class="input-group-text">Confirmar senha</span>
                            <input id="confirmPassword" name="ConfirmarSenha" type="password" class="form-control">
                        </div>

                    </div>

                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="submit" class="btn btn-primary">Inserir Dados</button>
                    </div>
                </form>

            </div>
        </div>
    </div>
    `;

    // ADICIONA O MODAL NO BODY
    document.body.insertAdjacentHTML('afterbegin', ModalHtml);

    const modalElement = document.getElementById('Adicionar');
    const modalBootstrap = new bootstrap.Modal(modalElement);
    modalBootstrap.show();

    modalElement.addEventListener('hidden.bs.modal', () => {
        modalElement.remove();
    });

    // VALIDAÇÃO DO FORMULÁRIO
    document.getElementById('formAdicionarUsuario')
        .addEventListener('submit', (event) => {

            event.preventDefault();

            const senha = document.getElementById('password').value;
            const confirma = document.getElementById('confirmPassword').value;

                if (senha !== confirma) {
                    alert("As senhas não coincidem!");
                    return;
                }

                const dados = {
                    PrimeiroNome: document.querySelector("[name='PrimeiroNome']").value,
                    SegundoNome: document.querySelector("[name='SegundoNome']").value,
                    email: document.querySelector("[name='email']").value,
                    telefone: document.querySelector("[name='telefone']").value,
                    senha: senha,
                    ConfirmarSenha: confirma
                };

            fetch("/registro", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(dados)
            })
            .then(res => res.json())
            .then(resposta => {
                alert(resposta.msg);

                if (resposta.ok) {
                    modalBootstrap.hide();
                    window.location.href = "PaginaInicial.html"; // redireciona após registro
                }
            })
            .catch(err => alert("Erro ao registrar: " + err));
        });
}

</script>
</body>
</html>