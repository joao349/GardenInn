<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>
    <link rel="stylesheet" href="formulario.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">  
</head>
<body style="font-family: playfair-display-uniquifier;">
  <nav class="navbar navbar-expand-lg bg-body-tertiary">
    <div class="container-fluid">
      <a href="PaginaInicial.html">
        <img class="LogoNav" src="Logo preta.png" alt="">
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      </div>

      <div class="metade">
        <a href="PaginaLogin.html">
          <img class="LogoLogin" style="margin-right: 10px;" src="IconeLogin.png" alt="">
        </a>
      </div>
    </div>
  </nav>
<p></p>
<div class="CentralizarTudo" id="orcamentos">
  <h2 style="color: green;">Solicite seu orçamento personalizado</h2>
</div>

<div class="CentralizarTudo">
  <p class="intro">Preencha o formulário abaixo com as informações do seu ambiente e suas preferências. 
    Nossa equipe especializada entrará em
    contato rapidamente com uma proposta personalizada, pensada especialmente para você.</p>
</div>

<div class="CentralizarTudo">
  <form id="orcamentoForm" onsubmit="exibirAlert(event)">
    <div class="CentralizarTudo">
    </div>

    <div class="CentralizarTudo">
      <label for="tipo-ambiente">Tipo de ambiente</label>
    </div>  
    <input type="text" id="tipo-ambiente" name="tipo-ambiente" placeholder="Residência /Comercial/ Outro" required>
    
    <div class="CentralizarTudo">
      <label for="dimensoes">Dimensões aproximadas da parede (em metros)</label>
    </div>
    <input type="number" id="dimensoes" name="dimensoes" placeholder="Altura X largura" required>

    <div class="CentralizarTudo">
      <label for="local">Local de instalação</label>
    </div>
    <input type="text" id="local" name="local" placeholder="Área interna / Área externa" required>

    <div class="CentralizarTudo">
      <label>Tipo de jardim desejado</label>
    </div>
    <div class="checkbox-group">
      <label><input type="checkbox" name="jardim" value="Irrigação automática"> Irrigação automática</label>
      <label><input type="checkbox" name="jardim" value="Irrigação manual"> Irrigação manual</label>
    </div>

    <p></p>
    <textarea name="descricao" rows="3" placeholder="Descreva sua ideia ou necessidade (opcional)"></textarea>

    <div class="CentralizarTudo">
      <button type="submit" class="botao">Enviar formulário</button>
    </div>
    <p></p>
    <p class="signup-link">
      Ficou com alguma dúvida? 
      <a href="PaginaLogada.html" class="signup-link-green">Use a nossa IA</a>
    </p>
  </form>
</div>

<script>
document.getElementById("orcamentoForm").addEventListener("submit", async function(event){
    event.preventDefault();

    // Pega os valores do formulário
    const tipoAmbiente = document.getElementById("tipo-ambiente").value;
    const dimensoes = document.getElementById("dimensoes").value;
    const local = document.getElementById("local").value;
    
    // Para checkbox, pega os selecionados
    const jardim = Array.from(document.querySelectorAll("input[name='jardim']:checked"))
                        .map(e => e.value);
    
    const descricao = document.querySelector("textarea[name='descricao']").value;

    const dados = { tipoAmbiente, dimensoes, local, jardim, descricao };

    try {
        const res = await fetch("/orcamento", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(dados)
        });

        const resposta = await res.json();
        alert(resposta.msg);

        if(resposta.ok){
            document.getElementById("orcamentoForm").reset();
        }
    } catch (err) {
        alert("Erro ao enviar o formulário: " + err);
    }
});
</script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>